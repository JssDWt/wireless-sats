(()=>{"use strict";var e={715:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bech32m=t.bech32=void 0;const n="qpzry9x8gf2tvdw0s3jn54khce6mua7l",r={};for(let e=0;e<n.length;e++){const t=n.charAt(e);r[t]=e}function o(e){const t=e>>25;return(33554431&e)<<5^996825010&-(t>>0&1)^642813549&-(t>>1&1)^513874426&-(t>>2&1)^1027748829&-(t>>3&1)^705979059&-(t>>4&1)}function i(e){let t=1;for(let n=0;n<e.length;++n){const r=e.charCodeAt(n);if(r<33||r>126)return"Invalid prefix ("+e+")";t=o(t)^r>>5}t=o(t);for(let n=0;n<e.length;++n){const r=e.charCodeAt(n);t=o(t)^31&r}return t}function c(e,t,n,r){let o=0,i=0;const c=(1<<n)-1,s=[];for(let r=0;r<e.length;++r)for(o=o<<t|e[r],i+=t;i>=n;)i-=n,s.push(o>>i&c);if(r)i>0&&s.push(o<<n-i&c);else{if(i>=t)return"Excess padding";if(o<<n-i&c)return"Non-zero padding"}return s}function s(e){return c(e,8,5,!0)}function a(e){const t=c(e,5,8,!1);if(Array.isArray(t))return t}function u(e){const t=c(e,5,8,!1);if(Array.isArray(t))return t;throw new Error(t)}function d(e){let t;function c(e,n){if(n=n||90,e.length<8)return e+" too short";if(e.length>n)return"Exceeds length limit";const c=e.toLowerCase(),s=e.toUpperCase();if(e!==c&&e!==s)return"Mixed-case string "+e;const a=(e=c).lastIndexOf("1");if(-1===a)return"No separator character for "+e;if(0===a)return"Missing prefix for "+e;const u=e.slice(0,a),d=e.slice(a+1);if(d.length<6)return"Data too short";let l=i(u);if("string"==typeof l)return l;const f=[];for(let e=0;e<d.length;++e){const t=d.charAt(e),n=r[t];if(void 0===n)return"Unknown character "+t;l=o(l)^n,e+6>=d.length||f.push(n)}return l!==t?"Invalid checksum for "+e:{prefix:u,words:f}}return t="bech32"===e?1:734539939,{decodeUnsafe:function(e,t){const n=c(e,t);if("object"==typeof n)return n},decode:function(e,t){const n=c(e,t);if("object"==typeof n)return n;throw new Error(n)},encode:function(e,r,c){if(c=c||90,e.length+7+r.length>c)throw new TypeError("Exceeds length limit");let s=i(e=e.toLowerCase());if("string"==typeof s)throw new Error(s);let a=e+"1";for(let e=0;e<r.length;++e){const t=r[e];if(t>>5!=0)throw new Error("Non 5-bit word");s=o(s)^t,a+=n.charAt(t)}for(let e=0;e<6;++e)s=o(s);s^=t;for(let e=0;e<6;++e)a+=n.charAt(s>>5*(5-e)&31);return a},toWords:s,fromWordsUnsafe:a,fromWords:u}}t.bech32=d("bech32"),t.bech32m=d("bech32m")},607:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function c(e){try{a(r.next(e))}catch(e){i(e)}}function s(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.handlePayment=t.handleLNURL=t.bin2String=t.lnurlDecode=t.NFCReader=void 0;const o=n(715);function i(e){if(-1!==e.indexOf("lnurlw:"))return e.replace("lnurlw:","https:");const t=o.bech32.decode(e.replace("lightning:",""),2e3);return c(o.bech32.fromWords(t.words))}function c(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}function s(e,t,n,o){return r(this,void 0,void 0,(function*(){try{const r=`${e}?k1=${t}&pr=${n.replace("lightning:","")}`,i=yield(yield fetch(`${o}?url=${encodeURIComponent(r)}`)).json();return"ERROR"===i.status?{success:!1,message:i.reason}:{success:!0,message:"invoice paid!"}}catch(e){return{success:!1,message:e.message}}}))}t.NFCReader=class{constructor(){this.listening=!1,"NDEFReader"in window?(this.available=!0,this.ndefReader=new NDEFReader):this.available=!1}listen(e){return r(this,void 0,void 0,(function*(){this.available&&this.ndefReader&&!this.listening&&(yield this.ndefReader.scan(),this.ndefReader.addEventListener("readingerror",(()=>{throw new Error("Error reading nfc")})),this.ndefReader.addEventListener("reading",(({message:t})=>{const n=t.records[0],r=new TextDecoder("utf-8").decode(n.data);e(r)})),this.listening=!0)}))}},t.lnurlDecode=i,t.bin2String=c,t.handleLNURL=function(e,t,n){return r(this,void 0,void 0,(function*(){try{const r=i(e),{callback:o,k1:c,reason:a,status:u}=yield(yield fetch(`${n}?url=${r}`)).json();return"ERROR"===u?{success:!1,message:a}:s(o,c,t,n)}catch(e){return{success:!1,message:e.message}}}))},t.handlePayment=s},463:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function c(e){try{a(r.next(e))}catch(e){i(e)}}function s(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(607);function i(e){const t=document.getElementById("textarea");t&&(t.value+=`${e}\n`)}document.addEventListener("DOMContentLoaded",(()=>r(void 0,void 0,void 0,(function*(){const e=document.getElementById("invoice"),t=document.getElementById("button");i("ready"),null==t||t.addEventListener("click",(()=>r(void 0,void 0,void 0,(function*(){try{const t=new o.NFCReader;yield t.listen((t=>{i(`lnurl: ${t}`),(0,o.handleLNURL)(t,null==e?void 0:e.value,"proxy.php").then((()=>i("done!!")))})),i("listening")}catch(e){i(e.message)}}))))}))))}},t={};!function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}(463)})();